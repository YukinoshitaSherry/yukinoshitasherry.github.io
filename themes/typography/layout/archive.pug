extends partial/layout
include mixins

block site_title
    !=  __("Archive") + " · " + config.title

block description
    - var desc = __("Archive") +' - ' + config.title;
    meta(name="description", content=desc)

block content
    .autopagerize_page_element: .content
        p.post-title
            != __("Archive") + ' ' + __('ArchiveCount', site.posts.length)
        .archive.animated.fadeInDown
            - var year = 0;
            - var month = 0;
            - var change = false;
            - var monthChange = false;
            - var firstYear = true;
            - var firstMonth = true;
            - page.posts = site.posts.sort('date', -1)
            
            //- 文章列表
            .posts-list
                - page.posts.each(function (item) {
                    - var itemYear = date(item.date, 'YYYY') - 0;
                    - var itemMonth = date(item.date, 'MM') - 0;
                    - change = year !== itemYear;
                    - monthChange = month !== itemMonth || change;
                    - year = change ? itemYear : year;
                    - month = monthChange ? itemMonth : month;
                    
                    if change
                        if !firstYear
                            | </div>
                        - firstYear = false
                        h2.archive-year!= itemYear
                        .year-container
                    
                    if monthChange
                        if !firstMonth
                            | </div>
                        - firstMonth = false
                        h3.archive-month!= itemMonth + "月"
                        .month-container
                    
                    .post-item-wrapper
                        +make_post(item, false)
                - })
                if !firstYear
                    | </div>

        if config.archive_generator.per_page
            +make_pager(__('prev'), __('next'))
