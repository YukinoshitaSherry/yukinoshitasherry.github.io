extends partial/layout

block site_title
    != __("Tags") + " · " + config.title

block description
    - var desc = __("Tags")+ ' - ' + config.title;
    meta(name="description", content=desc)

//- 词云图
block content
    .autopagerize_page_element: .content
        .archive.animated.fadeInDown
            p.post-title
                != __("Tags")
            #tagCloud(style="width: 100%; height: 500px; margin: 20px auto;")

            //- 直接从 Hexo 获取标签数据并转换为数组
            - var tagData = []
            - site.tags.each(function(tag) {
                - tagData.push({name: tag.name, value: tag.length, path: url_for(tag.path)})
            - })

            script(src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js")
            script(src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js")
            script.
                document.addEventListener('DOMContentLoaded', function() {
                    var chart = echarts.init(document.getElementById('tagCloud'));
                    var tags = !{JSON.stringify(tagData)};
                    
                    var option = {
                        series: [{
                            type: 'wordCloud',
                            shape: 'circle',
                            left: 'center',
                            top: 'center',
                            width: '80%',
                            height: '80%',
                            sizeRange: [14, 50],
                            rotationRange: [-45, 45],
                            rotationStep: 45,
                            gridSize: 20,
                            drawOutOfBound: false,
                            layoutAnimation: true,
                            textStyle: {
                                fontFamily: 'Times New Roman, 楷体',
                                fontWeight: 'bold',
                                color: function() {
                                    return ['#2e405b', '#4a5568', '#718096', '#4299e1', '#3490dc', '#2b6cb0'][Math.floor(Math.random() * 6)];
                                }
                            },
                            data: tags
                        }]
                    };

                    chart.setOption(option);
                    
                    chart.on('click', function(params) {
                        window.location.href = tags.find(t => t.name === params.name).path;
                    });

                    window.addEventListener('resize', function() {
                        chart.resize();
                    });
                });
